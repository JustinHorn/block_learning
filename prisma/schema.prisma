datasource db {
    provider = "postgresql"
    // provider = "sqlite"

    // url = "sqlite:./dev.db"

    url = env("DATABASE_URL")

}

// 2
generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["connectOrCreate"]
}

model User {
    id              Int        @id @default(autoincrement())
    name            String
    email           String     @unique
    password        String
    registeredAt    DateTime   @default(now())
    postedResources Resource[]
    likes           Like[]
    comments        Comment[]
}

model Resource {
    id          Int      @id @default(autoincrement())
    date        DateTime @default(now())
    title       String
    href        String
    imgUrl      String   @default("")
    github      String   @default("")
    description String   @default("")

    tags Tag[]

    postedBy User?     @relation(fields: [userdId], references: [id])
    userdId  Int?
    likes    Like[]
    comments Comment[]
}

model Comment {
    id          Int      @id @default(autoincrement())
    date        DateTime @default(now())
    text        String
    postedBy    User     @relation(fields: [userId], references: [id])
    userId      Int
    postedUnder Resource @relation(fields: [resourceId], references: [id])

    resourceId Int
}

model Like {
    id   Int      @id @default(autoincrement())
    date DateTime @default(now())
    user User     @relation(fields: [userId], references: [id])

    userId     Int
    resource   Resource @relation(fields: [resourceId], references: [id])
    resourceId Int
    @@unique([userId, resourceId])

}

model Tag {
    id        Int        @id @default(autoincrement())
    name      String     @unique
    resources Resource[]
}
